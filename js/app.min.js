(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0),sessionStorage.getItem("preloader")&&(document.querySelector(".preloader")&&document.querySelector(".preloader").classList.add("_hide"),document.querySelector(".wrapper").classList.add("_visible")),sessionStorage.getItem("money")||sessionStorage.setItem("money",2500),document.querySelector(".score")&&document.querySelectorAll(".score").forEach((e=>{e.textContent=sessionStorage.getItem("money")})),sessionStorage.getItem("resource")||sessionStorage.setItem("resource",50),document.querySelector(".resource")&&document.querySelectorAll(".resource").forEach((e=>{e.textContent=sessionStorage.getItem("resource")}));const t=document.querySelector(".preloader"),o=document.querySelector(".wrapper");function n(e,t,o){let n=+sessionStorage.getItem(o);sessionStorage.setItem(o,n-e),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.add("_delete-money"))),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem(o)))}),500),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_delete-money")))}),1900)}function r(e){document.querySelectorAll(e).forEach((e=>e.classList.add("_no-money"))),setTimeout((()=>{document.querySelectorAll(e).forEach((e=>e.classList.remove("_no-money")))}),1400)}function s(e,t){return Math.floor(Math.random()*(t-e)+e)}function c(e,t){sessionStorage.setItem(t,JSON.stringify(e))}function l(e,t){let o=a(e);o.push(t),c(o,e)}function a(e){let t=JSON.parse(sessionStorage.getItem(e));return t.sort((function(e,t){return e-t})),t}let i=document.querySelectorAll(".icon-anim img");document.querySelector(".icon-anim img")&&setInterval((()=>{!function(){let e=s(0,3),t=["jump","scale","rotate"],o=s(0,i.length);i.forEach((e=>{e.classList.contains("_anim-icon-jump")?e.classList.remove("_anim-icon-jump"):e.classList.contains("_anim-icon-scale")?e.classList.remove("_anim-icon-scale"):e.classList.contains("_anim-icon-rotate")&&e.classList.remove("_anim-icon-rotate")})),setTimeout((()=>{i[o].classList.add(`_anim-icon-${t[e]}`)}),100)}()}),2e4);const u=500,d=1e3,m=1500,_=2e3,y=100,g=250,f=450;function S(){if(!sessionStorage.getItem("weapons")){c(["1"],"weapons")}sessionStorage.getItem("current-weapon")||sessionStorage.setItem("current-weapon",1)}function p(){document.querySelector('[data-item-price="1"]').textContent=u,document.querySelector('[data-item-price="2"]').textContent=d,document.querySelector('[data-item-price="3"]').textContent=m,document.querySelector('[data-item-price="4"]').textContent=_,document.querySelector('[data-item-price="5"]').textContent=y,document.querySelector('[data-item-price="6"]').textContent=g,document.querySelector('[data-item-price="7"]').textContent=f,document.querySelector('[data-price="1"]').setAttribute("data-count",u),document.querySelector('[data-price="2"]').setAttribute("data-count",d),document.querySelector('[data-price="3"]').setAttribute("data-count",m),document.querySelector('[data-price="4"]').setAttribute("data-count",_),document.querySelector('[data-price="5"]').setAttribute("data-count",y),document.querySelector('[data-price="6"]').setAttribute("data-count",g),document.querySelector('[data-price="7"]').setAttribute("data-count",f)}function v(){let e=a("weapons"),t=document.querySelectorAll(".box-store");e.forEach((e=>{t.forEach((t=>{t.dataset.price==e&&(setTimeout((()=>{t.classList.add("_bought")}),0),document.querySelector(`[data-btn-price='${t.dataset.price}'] p`).textContent="Select")}))}))}function b(){let e=+sessionStorage.getItem("current-weapon");document.querySelectorAll(".box-store").forEach((t=>{t.dataset.price==e&&t.classList.add("_selected")}))}document.querySelector(".main")&&document.querySelector(".preloader").classList.contains("_hide")&&(document.querySelector(".main").classList.add("_active"),S(),p(),v(),b());const q=document.documentElement.clientWidth,L=document.documentElement.clientHeight,h={level:1,start_coord_x:q-100,start_coord_y:L-180,currentPosition:[q-100,L-50],weapon_speed:5,weapon_width:60,weapon_height:100,win_money:0,win_resource:0,timerIdBonus:!1,timerCl:!1},w={level_1:15,level_2:20,level_3:30,level_4:50,destroyFruits:0,count:0,currentCount:0},A={xLastOffset:0,yLastOffset:0,xCurrentOffset:0,yCurrentOffset:0,angle:0},x=["Great...!","SUPERB...!","Cool...!","Fantastic...!","Nice...!","Excelent...!","yeezy...!"];function I(e,t){document.querySelector(".footer__weapon").style.left=`${e}px`,document.querySelector(".footer__weapon").style.top=`${t}px`}function E(){!function(){let e=1200,t=!1;t=setInterval((()=>{1==h.level?e=1200:2==h.level?e=900:3==h.level?e=700:4==h.level&&(e=500)}),100),setTimeout((()=>{h.timerIdBonus=setInterval((()=>{!function(){let e=["limon","banan","orange","pear","plum","strawberry"],t=0,o=s(0,6),n=s(0,360);1==h.level?t=s(20,35):2==h.level?t=s(15,30):3==h.level?t=s(10,25):4==h.level&&(t=s(5,20));let r=s(20,+q-50),c=document.createElement("div");c.classList.add("field__fruit"),c.setAttribute("value",e[o]);let l=document.createElement("img");l.setAttribute("src",`img/fruit/${e[o]}.png`),l.setAttribute("alt","Image"),l.setAttribute("data-whole",""),l.style.transform=`rotate(${n}deg)`,c.append(l),c.style.left=`${r}px`,document.querySelector(".field__body").append(c);let a=!1,i=-40;a=setInterval((()=>{i+=5,c.style.top=`${i}px`,i>L+40&&(clearInterval(a),c.remove())}),t)}(),w.currentCount--,w.currentCount<=0&&clearInterval(h.timerIdBonus)}),e);let t=setInterval((()=>{document.querySelectorAll(".field__fruit").length<=0&&w.currentCount<=0&&(clearInterval(t),function(){O()?document.querySelector(".win__sub-text").textContent="victory":document.querySelector(".win__sub-text").textContent="lose";document.querySelector(".win__money").textContent=`+${h.win_money}`,document.querySelector(".win__resource").textContent=`+${h.win_resource}`,document.querySelector(".win").classList.add("_active"),function(e,t,o,n){let r=Math.floor(+sessionStorage.getItem("money")+e);setTimeout((()=>{sessionStorage.setItem("money",r),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem("money"))),document.querySelectorAll(t).forEach((e=>e.classList.add("_anim-add-money")))}),o),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_anim-add-money")))}),n)}(h.win_money,".score",500,1500),function(e,t,o,n){let r=Math.floor(+sessionStorage.getItem("resource")+e);setTimeout((()=>{sessionStorage.setItem("resource",r),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem("resource"))),document.querySelectorAll(t).forEach((e=>e.classList.add("_anim-add-money")))}),o),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_anim-add-money")))}),n)}(h.win_resource,".resource",500,1500)}())}),100)}),200)}(),h.timerCl=setInterval((()=>{h.currentPosition=function(){let e=document.querySelector(".footer__weapon"),t=window.getComputedStyle(e),o=parseInt(t.left,10),n=parseInt(t.top,10);return[o,n]}(),function(){let e=h.currentPosition[0],t=h.currentPosition[1];document.querySelectorAll(".field__fruit").forEach((o=>{let n=window.getComputedStyle(o),r=parseInt(n.left,10),c=parseInt(n.top,10);e+h.weapon_width>r&&t<c+h.weapon_height&&e<r+90&&t<c+90&&!o.classList.contains("_anim")?(!function(e,t,o){"limon"==e.getAttribute("value")?h.win_money+=50:"banan"==e.getAttribute("value")?h.win_resource+=10:"orange"==e.getAttribute("value")?h.win_money+=70:"pear"==e.getAttribute("value")?h.win_resource+=20:"plum"==e.getAttribute("value")?h.win_money+=65:"strawberry"==e.getAttribute("value")&&(h.win_money+=75);!function(e,t,o,n){let r=document.createElement("img"),s=document.createElement("img"),c=document.createElement("img");r.setAttribute("src",`img/fruit/${n}-1.png`),r.setAttribute("alt","image"),r.classList.add("field__piece-1"),r.style.left=`${t}px`,r.style.top=`${o}px`,s.setAttribute("src",`img/fruit/${n}-2.png`),s.setAttribute("alt","image"),s.classList.add("field__piece-2"),s.style.left=`${t}px`,s.style.top=`${o}px`,c.setAttribute("src",`img/fruit/${n}-blot.png`),c.setAttribute("alt","image"),c.classList.add("field__blot"),c.style.left=`${t}px`,c.style.top=`${o}px`,e.querySelector("[data-whole]").classList.add("_whole"),document.querySelector(".field__body").append(r,s,c),r.classList.add("_hide"),s.classList.add("_hide"),c.classList.add("_hide"),setTimeout((()=>{r.remove(),s.remove(),c.remove()}),5e3)}(e,t,o,e.getAttribute("value"))}(o,r,c),o.classList.add("_anim"),function(){let e=s(0,7),t=document.querySelector(".game__text");t.classList.contains("_text-anim")&&t.classList.remove("_text-anim");t.textContent=x[e],t.classList.add("_text-anim"),setTimeout((()=>{t.classList.remove("_text-anim")}),750)}(),++w.destroyFruits,setTimeout((()=>{o.remove()}),1500)):c>=L-80&&o.remove()}))}()}),100)}function C(){setTimeout((()=>{document.querySelector(".timer").classList.add("_active"),function(){let e=3;document.querySelector(".timer__count").textContent=e;let t=setInterval((()=>{0==e&&clearInterval(t),e--,document.querySelector(".timer__count").textContent=e}),1e3)}()}),500)}function T(){C(),setTimeout((()=>{E()}),3500)}function $(){1==h.level?w.count=w.level_1:2==h.level?w.count=w.level_2:3==h.level?w.count=w.level_3:4==h.level&&(w.count=w.level_4),w.currentCount=w.count}function O(){let e=w.destroyFruits/w.count*100;return h.level<=2&&e>=50||!(h.level<=2&&e<50)&&(h.level>2&&e>=75||!(h.level>2&&e<75)&&void 0)}document.querySelector(".game")&&document.querySelector(".preloader").classList.contains("_hide")&&(function(){let e=+sessionStorage.getItem("current-weapon"),t=document.createElement("img");setTimeout((()=>{t.setAttribute("src",`img/weapons/weapon-${e}.svg`),t.setAttribute("alt","Image"),document.querySelector(".footer__weapon").append(t)}),0)}(),$(),I(h.start_coord_x,h.start_coord_y),T(),function(){let e,t,o,n,r,s,c,l=document.querySelector(".game"),a=!1;l.addEventListener("touchstart",(function(n){a=!0;let r=n.changedTouches[0];o=0,e=r.pageX,t=r.pageY,s=(new Date).getTime(),I(n.changedTouches[0].clientX-60,n.changedTouches[0].clientY-60),A.xLastOffset=n.changedTouches[0].clientX-60,A.yLastOffset=n.changedTouches[0].clientY-60}),!1),l.addEventListener("touchmove",(function(o){var s=o.changedTouches[0];n=e-s.pageX,r=t-s.pageY,c=Math.atan2(r,n);var l=c*(180/3.14);I(o.touches[0].clientX-60,o.touches[0].clientY-60),document.querySelector(".footer__weapon").style.transform=`rotate(${l}deg)`}),!1),l.addEventListener("touchend",(function(e){I(q-100,L-150),document.querySelector(".footer__weapon").style.transform="rotate(0deg)"}),!1)}()),document.addEventListener("click",(e=>{let s=e.target;s.closest(".preloader__button")&&setTimeout((()=>{sessionStorage.setItem("preloader",!0),t.classList.add("_hide"),o.classList.add("_visible"),document.querySelector(".main")&&document.querySelector(".preloader").classList.contains("_hide")&&(document.querySelector(".main").classList.add("_active"),S(),p(),v(),b())}),300),s.closest('[data-button="store"]')&&document.querySelector(".main__body").classList.add("_store"),s.closest('[data-button="to-main"]')&&document.querySelector(".main__body").classList.remove("_store"),s.closest('[data-button="to-main"]')&&document.querySelector(".main__body").classList.remove("_store"),s.closest(".box-store__button")&&s.closest(".store__box")&&!s.closest(".store__box").classList.contains("_bought")&&(!function(e){let t=e.dataset.count,o=e.dataset.price;o<5?+sessionStorage.getItem("money")>=t?(setTimeout((()=>{e.classList.add("_bought")}),0),n(t,".score","money"),l("weapons",o)):r(".score"):o>=5&&(+sessionStorage.getItem("resource")>=t?(setTimeout((()=>{e.classList.add("_bought")}),0),n(t,".resource","resource"),l("weapons",o)):r(".resource"))}(s.closest(".store__box")),v()),s.closest(".box-store__button")&&s.closest(".store__box")&&s.closest(".store__box").classList.contains("_bought")&&(document.querySelectorAll(".box-store").forEach((e=>{e.classList.contains("_selected")&&e.classList.remove("_selected")})),setTimeout((()=>{s.closest(".store__box").classList.add("_selected")}),300),sessionStorage.setItem("current-weapon",s.closest(".store__box").dataset.price)),s.closest(".win__button")&&(!function(){document.querySelectorAll(".field__piece-1").forEach((e=>e.remove())),document.querySelectorAll(".field__piece-2").forEach((e=>e.remove())),document.querySelectorAll(".field__blot").forEach((e=>e.remove()));let e=O();h.level<4&&e&&++h.level,document.querySelector(".timer").classList.remove("_active"),$(),h.win_money=0,h.win_resource=0,w.destroyFruits=0}(),function(){let e=document.querySelector(".wrapper");e.classList.contains("_bg-1")?e.classList.remove("_bg-1"):e.classList.contains("_bg-2")?e.classList.remove("_bg-2"):e.classList.contains("_bg-3")&&e.classList.remove("_bg-3"),e.classList.add(`_bg-${h.level}`)}(),document.querySelector(".win").classList.remove("_active"),T())})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)})),window.addEventListener("load",(function(){document.querySelector("body")&&setTimeout((function(){document.querySelector("body").classList.add("_loaded")}),200)}))})();